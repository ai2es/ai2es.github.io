<!DOCTYPE html>
<html>
<script src="https://d3js.org/d3-fetch.v3.min.js"></script>
<script src="https://cdn.plot.ly/plotly-2.5.1.min.js"></script>
<script>
var grid_file = "https://gridrad-storm.s3.us-west-2.amazonaws.com/storm_poly_YYYYMMDD.geojson";
async function update() {
    sel_date = document.getElementById("date_sel").value;
    grid_file_date = grid_file.replace("YYYYMMDD", sel_date);
    var data = await d3.json(grid_file_date);

    console.log(data);
    var lats = [];
    var lons = [];
    for (let i = 0; i < data.features.length; i++) {
        lats[i] = (data.features[i].properties.centroid_latitude_deg);
        lons[i] = (data.features[i].properties.centroid_longitude_deg);
    }
    var plot_data = [{type: "scattermapbox", lon: lons, lat: lats}];
    console.log(lons);
    console.log(lats);
    // document.getElementById("test").innerHTML = JSON.stringify(data.features[0]);
    var layout = {mapbox: {center: {lon: -90, lat: 30}, zoom: 2, style: "open-street-map"}, width: 1000, height: 800}
    Plotly.newPlot(test, plot_data, layout);
}
</script>

<body>
<button type="button" id="try" onclick="update()">Load</button>
<select id="date_sel", name="date_sel", onchange="update()">
<option value="20110427">2011-04-27</option>
<option value="20130519">2013-05-19</option>
<option value="20130520">2013-05-20</option>
</select>
<div id="test">
</div>

</body>
</html>
